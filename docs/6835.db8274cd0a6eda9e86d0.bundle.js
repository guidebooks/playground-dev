"use strict";(self.webpackChunkKuiClientTemplate=self.webpackChunkKuiClientTemplate||[]).push([[6835],{86835:(t,n,e)=>{e.r(n),e.d(n,{preload:()=>l,plugin:()=>u});var i=e(26470),r=e(18495),o=e(94854),c=function(t,n,e,i){return new(e||(e=Promise))((function(r,o){function c(t){try{a(i.next(t))}catch(t){o(t)}}function s(t){try{a(i.throw(t))}catch(t){o(t)}}function a(t){var n;t.done?r(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(c,s)}a((i=i.apply(t,n||[])).next())}))};function s(t,n,{toBeCompleted:e}){return c(this,void 0,void 0,(function*(){return(yield t.REPL.rexec(`fscomplete -- "${e}"`)).content}))}function a(t){return c(this,void 0,void 0,(function*(){const n=t.command.substring(t.command.indexOf("-- ")+"-- ".length).replace(/^"(.*)"$/,"$1"),e="/"===n.charAt(n.length-1),c=e?n:(0,i.dirname)(n);if(c)try{const s=r.Util.expandHomeDir(c),a=yield(0,o.ls)({tab:t.tab,REPL:t.REPL,parsedOptions:{a:!0}},[s]),l=function(t,n,e,r){const o=(0,i.basename)(e)+(r?"/":""),c=o.startsWith("."),s=t.filter((t=>{const n=t.name;return(r||0===n.indexOf(o))&&!n.endsWith("~")&&"."!==n&&".."!==n&&(c||!n.startsWith("."))})),a=/\//.test(e);return s.map((t=>{const n=t.nameForDisplay,e=r?n:n.substring(o.length),c=a?(0,i.basename)(t.nameForDisplay):void 0;return t.dirent.isDirectory||t.dirent.isSymbolicLink?{completion:/\/$/.test(e)?e:`${e}/`,label:c?/\/$/.test(c)?c:`${c}/`:void 0}:{completion:e,addSpace:!0,label:c}}))}(yield a,0,n,e);return{mode:"raw",content:l&&0!==l.length?l:[]}}catch(t){throw console.error("tab completion vfs.ls error",t),t}}))}function l(){(0,r.registerTabCompletionEnumerator)(s,-100)}function u(t){t.listen("/fscomplete",a,{hidden:!0,requiresLocal:!0})}},49287:(t,n,e)=>{e.d(n,{Z:()=>a});var i=e(26470),r=e(18495),o=e(14176),c=function(t,n,e,i){return new(e||(e=Promise))((function(r,o){function c(t){try{a(i.next(t))}catch(t){o(t)}}function s(t){try{a(i.throw(t))}catch(t){o(t)}}function a(t){var n;t.done?r(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(c,s)}a((i=i.apply(t,n||[])).next())}))};class s extends o.t{constructor(){super("/",r.commandsTrie)}isLeaf(t){return super.isLeaf(t)||!t.isDirectory}loadAsString(){return""}trieGet(t){return this.fillInParents(t,Array.from(new Set(this.trie.get(t))).map(this.direntry))}parentsOf(t,n){const e=[];for(t=(0,i.dirname)(t);t.length>=n.length&&(e.push({mountPath:t+"/",isDirectory:!0}),"/"!==t);)t=(0,i.dirname)(t);return e}fillInParents(t,n){const e=r.Util.flatten(n.map((n=>this.parentsOf(n.mountPath,t.replace(/\/$/,"")))));return n.concat(e)}direntry(t){return{mountPath:t,isDirectory:!1,isExecutable:!0}}viewer(){return""}ls(t,n){const e=Object.create(null,{ls:{get:()=>super.ls}});return c(this,void 0,void 0,(function*(){const i=yield e.ls.call(this,t,n);if(i.length>0){const t={};return i.filter((n=>!t[n.path]&&(t[n.path]=!0,!0)))}return i}))}}const a=new s},94854:(t,n,e)=>{e.d(n,{ls:()=>p,cp:()=>y,rm:()=>v,UK:()=>g,KC:()=>b,zG:()=>w,ot:()=>P,i$:()=>L,ZD:()=>x});var i=e(11227),r=e.n(i),o=e(26470),c=e(18495),s=e(42007),a=e(49287),l=e(48764).Buffer,u=function(t,n,e,i){return new(e||(e=Promise))((function(r,o){function c(t){try{a(i.next(t))}catch(t){o(t)}}function s(t){try{a(i.throw(t))}catch(t){o(t)}}function a(t){var n;t.done?r(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(c,s)}a((i=i.apply(t,n||[])).next())}))};const f=r()("plugin/bash-like/fs/vfs/delegates");function d(t,n){let e=0;for(let i=0;i<t.length;i++)if("/"===t.charAt(i)&&e++===n)return t.slice(0,i);return t}const h={size:0,mtimeMs:0,uid:0,gid:0,mode:0};function m(t){return u(this,void 0,void 0,(function*(){/[*/]$/.test(t)||(t+="/");const n=function(t){let n=0;for(let e=0;e<t.length;e++)"/"===t.charAt(e)&&n++;return n}(t);try{const i=yield(0,s.kU)(t);if(i)return(e=i.filter((t=>!t.isLocal)).map((t=>({mountPath:d(t.mountPath,n),isLocal:t.isLocal,tags:t.tags}))),e.filter((({mountPath:t},n)=>e.findIndex((n=>n.mountPath===t))===n))).map((({mountPath:t,isLocal:n,tags:e})=>({name:(0,o.basename)(t),nameForDisplay:(0,o.basename)(t),path:t,stats:h,dirent:{mount:{isLocal:n,tags:e,mountPath:t},isFile:!1,isDirectory:!0,isSymbolicLink:!1,isSpecial:!1,isExecutable:!1,permissions:"",username:""}})))}catch(t){throw console.error("tab completion vfs match mounts error",t),t}var e}))}function p(...t){return u(this,void 0,void 0,(function*(){const n=0===t[1].length?[c.Util.cwd()]:t[1].map(s.AG),e=yield(0,s.tH)(n,!0),i=Promise.all(e.map((({filepaths:n,mount:e})=>u(this,void 0,void 0,(function*(){try{return yield e.ls(t[0],n)}catch(t){if(404!==t.code)throw/globby is not defined/.test(t.message)||f(t),t}}))))).then(c.Util.flatten),r=Promise.all(n.map(m)),o=a.Z.ls(t[0],n),l=c.Util.flatten(yield r);if(0===e.length&&0===l.length){const t=new Error(`VFS not mounted: ${n}`);throw t.code=404,t}const d=yield o;return function(t){const n=new Set;return t.filter((t=>{const e=t.path.replace(/\/$/,"");return!n.has(e)&&n.add(e)}))}((yield i).filter((t=>t)).concat(d).concat(l)).sort(((t,n)=>t.name.localeCompare(n.name)))}))}function y(t,n,e){return u(this,void 0,void 0,(function*(){const i=yield Promise.all(n.map((t=>(0,s.Xy)(t)))),r=yield(0,s.Xy)(e);if(r.isLocal){const o=i.map(((t,e)=>t.isLocal?n[e]:void 0)).filter((t=>t)),c=i.map(((t,e)=>t.isLocal?void 0:{filepath:n[e],mount:t})).filter((t=>t)),s=0===o.length?[]:[r.cp(t,o,e,o.map((()=>!0)),!0,i,r)];if(c.length>0){const n=c[0].mount,o=r===n;s.push(n.cp(t,c.map((t=>t.filepath)),e,c.map((t=>t.mount===n)),o,i,r))}const a=yield Promise.all(s);return 1===a.length&&!0===a[0]||a.join(", ")}{const o=r,c=i.map((t=>t===o)),s=r===o;return o.cp(t,n,e,c,s,i,r)}}))}function v(...t){return u(this,void 0,void 0,(function*(){return(yield(0,s.Xy)(t[1])).rm(t[0],t[1],t[2])}))}function g(...t){return u(this,void 0,void 0,(function*(){return(yield(0,s.Xy)(t[1])).fstat(t[0],t[1],t[2],t[3])}))}function b(...t){return u(this,void 0,void 0,(function*(){return(yield(0,s.Xy)(t[1])).fwrite(t[0],t[1],t[2],t[3])}))}function w(t,n,e,i){return u(this,void 0,void 0,(function*(){const r=yield(0,s.Xy)(t,void 0,!0);if(!r||!r.pipe)throw new Error(`pipe: can not find ${t}`);return r.pipe(t,n,e,i)}))}function P(t,n,e,i="bytes",r){return u(this,void 0,void 0,(function*(){const o=yield(0,s.Xy)(t,void 0,!0);if(!o)throw new Error(`fslice: can not find ${t}`);if("bytes"===i)return o.fslice(t,n,e);{let i=n,c="";for(;;)try{const n=yield o.fslice(t,i,void 0!==r?r-i:4e3);if(!n){console.error("bash-like fslice: no data read");break}{c=c.concat(n);const t=c.split("\n");if(t.length>=Math.abs(e)){c=(e<0?t.slice(e):t.slice(0,e)).join("\n");break}i=l.from(c).length}}catch(t){f(t);break}return c}}))}function L(...t){return u(this,void 0,void 0,(function*(){return(yield(0,s.Xy)(t[1])).mkdir(t[0],t[1])}))}function x(...t){return u(this,void 0,void 0,(function*(){return(yield(0,s.Xy)(t[1])).rmdir(t[0],t[1])}))}}}]);