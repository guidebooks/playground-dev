(self.webpackChunkKuiClientTemplate=self.webpackChunkKuiClientTemplate||[]).push([[4527],{99620:(n,t,e)=>{"use strict";e.d(t,{Z:()=>i});const i="github.com/kui-shell/plugin-kubectl/v1alpha1"},86208:(n,t,e)=>{"use strict";e.r(t),e.d(t,{default:()=>C});var i=e(53450);function o(n,t){return(0,i.lN)(n)||new RegExp(`\\s*helm ${t}\\s*$`).test(n.command)}function r(n){return(0,i.d1)(n,void 0,"helm")}var c=e(99620),u=function(n,t,e,i){return new(e||(e=Promise))((function(o,r){function c(n){try{a(i.next(n))}catch(n){r(n)}}function u(n){try{a(i.throw(n))}catch(n){r(n)}}function a(n){var t;n.done?o(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(c,u)}a((i=i.apply(n,t||[])).next())}))};function a(n){return u(this,void 0,void 0,(function*(){if(o(n,"get"))return(0,i.t$)("helm",n);const{argvNoOptions:t}=n,e=t.indexOf("get")+1,u=t.length-1,a=e<u?t[e]:void 0,s=t[u],l=yield r(n);if(a)return l;const h=l.match(/REVISION:\s+(\S+)[\n\r]+RELEASED:\s+([^\n\r]+)[\n\r]+CHART:\s+(\S+)/);if(!h)return l;const f=h[1],m=h[2],d=Math.min(l.indexOf("USER-SUPPLIED VALUES"),l.indexOf("COMPUTED VALUES"));return{apiVersion:c.Z,kind:"HelmRelease",metadata:{name:s,generation:f,creationTimestamp:m},summary:{content:l.substring(0,d).trim(),contentType:"yaml"},isSimulacrum:!0,originatingCommand:n,isKubeResource:!0,kuiRawData:l,modes:[]}}))}var s=function(n,t,e,i){return new(e||(e=Promise))((function(o,r){function c(n){try{a(i.next(n))}catch(n){r(n)}}function u(n){try{a(i.throw(n))}catch(n){r(n)}}function a(n){var t;n.done?o(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(c,u)}a((i=i.apply(n,t||[])).next())}))};var l=function(n,t,e,i){return new(e||(e=Promise))((function(o,r){function c(n){try{a(i.next(n))}catch(n){r(n)}}function u(n){try{a(i.throw(n))}catch(n){r(n)}}function a(n){var t;n.done?o(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(c,u)}a((i=i.apply(n,t||[])).next())}))};function h(n){return l(this,void 0,void 0,(function*(){if((0,i.lN)(n))return(0,i.t$)("helm",n);const t=yield r(n),e=(0,i.hO)(t.split(/^(?=LAST SEEN|NAMESPACE|NAME\s+)/m));return 0===e[0].length||(0,i.xM)("helm","get",void 0,n,e[0])}))}var f=function(n,t,e,i){return new(e||(e=Promise))((function(o,r){function c(n){try{a(i.next(n))}catch(n){r(n)}}function u(n){try{a(i.throw(n))}catch(n){r(n)}}function a(n){var t;n.done?o(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(c,u)}a((i=i.apply(n,t||[])).next())}))};function m(n){return f(this,void 0,void 0,(function*(){if(o(n,"repo"))return(0,i.t$)("helm",n);const t=yield r(n),e=(0,i.hO)(t.split(/^(?=LAST SEEN|NAMESPACE|NAME\s+)/m));return(0,i.xM)("helm",void 0,void 0,n,e[0])}))}var d=function(n,t,e,i){return new(e||(e=Promise))((function(o,r){function c(n){try{a(i.next(n))}catch(n){r(n)}}function u(n){try{a(i.throw(n))}catch(n){r(n)}}function a(n){var t;n.done?o(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(c,u)}a((i=i.apply(n,t||[])).next())}))};function v(n){return d(this,void 0,void 0,(function*(){if(o(n,"search"))return(0,i.t$)("helm",n);const t=yield r(n),e=(0,i.hO)(t.split(/^(?=LAST SEEN|NAMESPACE|NAME\s+)/m));return(0,i.xM)("helm",void 0,void 0,n,e[0])}))}var p=e(11227),y=e.n(p),E=e(18495),w=function(n,t,e,i){return new(e||(e=Promise))((function(o,r){function c(n){try{a(i.next(n))}catch(n){r(n)}}function u(n){try{a(i.throw(n))}catch(n){r(n)}}function a(n){var t;n.done?o(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(c,u)}a((i=i.apply(n,t||[])).next())}))};const x=(0,E.i18n)("plugin-kubectl"),S=(0,E.i18n)("plugin-kubectl","helm"),g=y()("plugin-kubectl/helm/controller/helm/status");function b(n){return w(this,void 0,void 0,(function*(){if(o(n,"status"))return(0,i.t$)("helm",n);const t=n.argvNoOptions[n.argvNoOptions.indexOf("status")+1],e=yield r(n);try{return((n,t,e,i)=>w(void 0,void 0,void 0,(function*(){g("nested?",i.nested),g("command","kubectl"),g("verb","get");const[t]=e.split(/RESOURCES:|(?=NOTES:)/),o=(e.match(/^NAMESPACE:\s+(.*)$/m)||[])[1];g("namespace",o);const r=(e.match(/^REVISION:\s+(.*)$/m)||[])[1];g("revision",r);const c=[];if(g("resources",c),i.nested)return g("returning tables for nested call"),Promise.all(c.map((({kind:n,table:t})=>w(void 0,void 0,void 0,(function*(){const e=yield t;return e.title=n,e})))));{const i=e.match(/NOTES:\n([\s\S]+)?/),o=t.match(/LAST DEPLOYED: (.*)\nNAMESPACE: (.*)\nSTATUS: (.*)/),u=o?`### ${S("Last Deployed")}\n${o[1]}\n\n### ${S("Namespace")}\n${o[2]}\n\n### ${S("Revision")}\n${r}\n\n### ${x("status")}\n\`${o[3]}\`\n`:t,a="",s=i&&i[1],l={label:"Overview",items:[{mode:"status",label:x("status"),content:u,contentType:"text/markdown"}].concat(a?[{mode:"summary",label:x("summary"),content:a,contentType:"text/markdown"}]:[]).concat(s?[{mode:"notes",label:S("Notes"),content:`\`\`\`${s}\`\`\``,contentType:"text/markdown"}]:[])},h={label:"Resources",items:yield Promise.all(c.map((n=>w(void 0,void 0,void 0,(function*(){return{mode:n.kind,content:yield n.table}})))))};return{apiVersion:"kui-shell/v1",kind:"NavResponse",breadcrumbs:[{label:"helm"},{label:"release",command:"helm ls"},{label:n}],menus:[l,h]}}})))(t,0,e,n.execOptions)}catch(n){return console.error("error formatting status",n),e}}))}var N=function(n,t,e,i){return new(e||(e=Promise))((function(o,r){function c(n){try{a(i.next(n))}catch(n){r(n)}}function u(n){try{a(i.throw(n))}catch(n){r(n)}}function a(n){var t;n.done?o(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(c,u)}a((i=i.apply(n,t||[])).next())}))};const A=/^NAME:\s+([\w-]+)/;function P(n){return N(this,void 0,void 0,(function*(){if(o(n,"install"))return(0,i.t$)("helm",n);if(/[\n;&]/.test(n.command))return(0,i.fF)(n,void 0,"helm");try{const t=yield r(n),e=t.match(A)[1];return n.REPL.qexec(`helm status ${n.REPL.encodeComponent(e)} ${(0,i.UU)(n)}`).catch((n=>(console.error("error in helm get for helm install",n),t)))}catch(n){throw/still in use/.test(n.message)&&(n.code=409,n.statusCode=409),n}}))}var $=function(n,t,e,i){return new(e||(e=Promise))((function(o,r){function c(n){try{a(i.next(n))}catch(n){r(n)}}function u(n){try{a(i.throw(n))}catch(n){r(n)}}function a(n){var t;n.done?o(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(c,u)}a((i=i.apply(n,t||[])).next())}))};function O(n){return $(this,void 0,void 0,(function*(){if(o(n,"history"))return(0,i.t$)("helm",n);const t=yield r(n),e=(0,i.hO)(t.split(/^(?=LAST SEEN|NAMESPACE|NAME\s+)/m));return(0,i.xM)("helm",void 0,void 0,n,e[0])}))}var k=function(n,t,e,i){return new(e||(e=Promise))((function(o,r){function c(n){try{a(i.next(n))}catch(n){r(n)}}function u(n){try{a(i.throw(n))}catch(n){r(n)}}function a(n){var t;n.done?o(n.value):(t=n.value,t instanceof e?t:new e((function(n){n(t)}))).then(c,u)}a((i=i.apply(n,t||[])).next())}))};const C=n=>k(void 0,void 0,void 0,(function*(){(n=>{n.listen("/helm/get",a)})(n),(n=>{s(void 0,void 0,void 0,(function*(){n.listen("/_helm",i.g8,Object.assign({},i.pb,{requiresLocal:!0}))}))})(n),(n=>{n.listen("/helm/ls",h),n.listen("/helm/list",h)})(n),(n=>{n.listen("/helm/repo/ls",m),n.listen("/helm/repo/list",m)})(n),(n=>{n.listen("/helm/search",v)})(n),(n=>{n.listen("/helm/status",b)})(n),(n=>{n.listen("/helm/install",P)})(n),(n=>{n.listen("/helm/history",O)})(n),(n=>{E.Capabilities.inBrowser()&&!E.Capabilities.hasProxy()||n.catchall((n=>(n=>/^helm$/.test(n[0])&&n.every((n=>!/(\\|\n|;|&)/.test(n))))(n)),(n=>(0,i.lN)(n)||1===n.argv.length&&"helm"===n.argv[0]?(0,i.t$)("helm",n):r(n)),1)})(n)}))},47689:()=>{}}]);