(self.webpackChunkKuiClientTemplate=self.webpackChunkKuiClientTemplate||[]).push([[3200,561],{13758:(e,t,n)=>{"use strict";n.r(t),n.d(t,{initMainPty:()=>s.O});var s=n(62549)},62549:(e,t,n)=>{"use strict";n.d(t,{Z:()=>c,O:()=>d});var s=n(17187),i=n(96690),r=n(29224),o=function(e,t,n,s){return new(n||(n=Promise))((function(i,r){function o(e){try{h(s.next(e))}catch(e){r(e)}}function a(e){try{h(s.throw(e))}catch(e){r(e)}}function h(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}h((s=s.apply(e,t||[])).next())}))};function a(e){return`/plugin-bash-like/pty/message/${e}`}class h extends s.EventEmitter{constructor(){super(...arguments),this.isAlive=!0,this.readyState=i.kQ.OPEN,this.handleMessage=(e,t)=>{this.emit("message",t)}}init(e,t){return o(this,void 0,void 0,(function*(){const{ipcMain:s}=yield Promise.resolve().then(n.t.bind(n,7676,23));this.ipcMain=s,this.otherSide=t,this.messageChannel=a(e.execUUID),s.on(this.messageChannel,this.handleMessage),yield(0,r.disableBashSessions)(),yield(0,r.onConnection)((()=>{try{this.ipcMain.off(this.messageChannel,this.handleMessage)}catch(e){console.error("Error turning off PTY events",e)}}))(this)}))}close(){}send(e){try{this.otherSide.isDestroyed()||this.otherSide.send(this.messageChannel,e)}catch(e){console.error("Error sending PTY output to renderer",e)}}removeEventListener(e,t){this.off(e,t)}}class c extends s.EventEmitter{constructor(){super(...arguments),this.isAlive=!0,this.readyState=i.kQ.OPEN,this.handleMessage=(e,t)=>{this.emit("message",t)}}init(e){return o(this,void 0,void 0,(function*(){const{ipcRenderer:t}=yield Promise.resolve().then(n.t.bind(n,7676,23));this.ipcRenderer=t,this.messageChannel=a(e),window.addEventListener("beforeunload",(()=>{this.send(JSON.stringify({type:"kill",uuid:e})),this.ipcRenderer.off(this.messageChannel,this.handleMessage)})),t.once(`/exec/response/${e}`,((e,t)=>{!0===JSON.parse(t).returnValue&&(this.ipcRenderer.on(this.messageChannel,this.handleMessage),this.emit("open"))})),t.send("/exec/invoke",JSON.stringify({module:"plugin-bash-like",main:"initMainPty",hash:e,args:{execUUID:e}}))}))}close(){}send(e){try{this.ipcRenderer.send(this.messageChannel,e.toString())}catch(e){console.error("Error sending PTY message to main process",e)}}removeEventListener(e,t){this.off(e,t)}}function d(e,t){return o(this,void 0,void 0,(function*(){try{return yield(new h).init(e,t),!0}catch(e){return console.error("Error starting up pty",e),!1}}))}},67953:()=>{},10561:()=>{}}]);