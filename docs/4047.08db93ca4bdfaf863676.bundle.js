"use strict";(self.webpackChunkKuiClientTemplate=self.webpackChunkKuiClientTemplate||[]).push([[4047],{67712:(e,t,n)=>{n.d(t,{XN:()=>a,Io:()=>l,MA:()=>d});var i=n(11227),o=n.n(i),r=n(16426),c=function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function c(e){try{a(i.next(e))}catch(e){r(e)}}function s(e){try{a(i.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((i=i.apply(e,t||[])).next())}))};const s=o()("plugins/bash-like/cmds/catchall"),a=({tab:e,REPL:t,command:i,argv:o,argvNoOptions:s,execOptions:a,parsedOptions:l,createOutputStream:d})=>c(void 0,void 0,void 0,(function*(){const c=e=>{if(e.message&&"string"==typeof e.message){const t=new Error(e.message.replace(/[a-zA-Z0-9/]+:\s*/,"").trim());throw t.code=e.code,t}throw e},{ExecType:u}=yield Promise.resolve().then(n.bind(n,18495)),p=(a.raw||a.type===u.Nested)&&void 0===a.quiet&&void 0===a.echo&&void 0===a.replSilence,h=p||a.isProxied?a:Object.assign({cwd:yield(0,r.Z)(a,t)},{stdout:yield d()},a),f=i.replace(/^(!|sendtopty)\s+/,""),{Capabilities:v}=yield Promise.resolve().then(n.bind(n,18495));if(v.isHeadless()||!v.inBrowser()&&p){const{doExec:e}=yield n.e(3228).then(n.bind(n,51956)),t="sendtopty"===o[0]?o.slice(1):o,i=yield e(f,t,h).catch(c);if(p&&("number"==typeof i||"boolean"==typeof i))return i;if(p&&"string"==typeof i)try{return isNaN(parseInt(i))?JSON.parse(i):i}catch(e){}return i}{const{doExec:i}=yield Promise.all([n.e(8575),n.e(9267),n.e(9224),n.e(2320),n.e(8885),n.e(116)]).then(n.bind(n,48885)),o=()=>i(e,t,f,s,l,h);if(p){h.quiet=!0,h.echo=!1,h.replSilence=!0;let e="";return h.onInit=()=>t=>{"string"==typeof t&&(e+=t)},o().then((()=>e)).catch(c)}return o().catch(c)}}));function l(e){return c(this,void 0,void 0,(function*(){const{Capabilities:t}=yield Promise.resolve().then(n.bind(n,18495));return new Promise(((n,i)=>c(this,void 0,void 0,(function*(){let o="";const r=Object.assign({},e.execOptions,{rethrowErrors:!0,quiet:!0,replSilence:!0,echo:!1,onInit:()=>e=>{"string"==typeof e&&(o+=e)}}),c=Object.assign({},e,{execOptions:r});yield a(c).catch((e=>{const n=o||e.message;o&&t.isHeadless()?s(n):s(e),e.message=n,i(e)})),n(o)}))))}))}const d=e=>c(void 0,void 0,void 0,(function*(){const{Capabilities:t}=yield Promise.resolve().then(n.bind(n,18495));if(!t.inBrowser()||t.hasProxy())return e.catchall((()=>!0),a,0);s("skipping catchall registration: in browser and no remote proxy to support it")}))},16426:(e,t,n)=>{n.d(t,{Z:()=>r});var i=n(18495),o=function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function c(e){try{a(i.next(e))}catch(e){r(e)}}function s(e){try{a(i.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((i=i.apply(e,t||[])).next())}))};function r(e,t){return o(this,void 0,void 0,(function*(){return e.cwd||((yield t.rexec(`vfs ls -d ${(0,i.encodeComponent)(i.Util.cwd())}`)).content[0].dirent.mount.isLocal?i.Util.cwd():i.Util.expandHomeDir("~"))}))}},54047:(e,t,n)=>{n.r(t),n.d(t,{default:()=>g,registerCapability:()=>w});var i=n(11227),o=n.n(i),r=n(18495);const c="v1",s="plugins/plugin-bash-like";function a(e,t){return e.getState(s,c,t)}var l=n(186);const d=o()("plugins/bash-like/tab-state");function u(e,t,n){e.setState(s,c,t,n)}const p=e=>{u(e,"env",Object.assign({},l.env)),u(e,"cwd",r.Util.cwd()),d("captured tab state",e.uuid,a(e,"cwd"))},h=e=>{const t=a(e,"env"),n=a(e,"cwd");if(d("restoring state",e.uuid,n),l.env=t,void 0!==n)if(r.Capabilities.inBrowser()||l.env.VIRTUAL_CWD)d("changing cwd",l.env.PWD,n),l.env.PWD=n;else try{d("changing cwd",n),l.chdir(n)}catch(e){console.error(`Error in chdir, using fallback plan: ${r.Util.fallbackCWD(n)}`,e);try{l.chdir(r.Util.fallbackCWD(n))}catch(e){console.error(e),l.chdir(r.Util.fallbackCWD())}}},f=(e,t)=>{p(e),h(t)};var v=n(67712),y=function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function c(e){try{a(i.next(e))}catch(e){r(e)}}function s(e){try{a(i.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((i=i.apply(e,t||[])).next())}))};const b=o()("plugins/bash-like/preload");b("loading");const w=e=>y(void 0,void 0,void 0,(function*(){if(r.Capabilities.inBrowser())yield n.e(3129).then(n.bind(n,3129)).then((({init:t})=>t(e)));else if(!r.Capabilities.isHeadless()||r.Capabilities.inProxy())try{const e=(yield n.e(9805).then(n.bind(n,49805))).default;yield e(),b("done with state prefetch")}catch(e){console.error("error in state prefetch",e)}})),g=e=>y(void 0,void 0,void 0,(function*(){return(0,r.registerTabState)({name:s,apiVersion:c,capture:p,restore:h,switchTo:f}),(0,v.MA)(e)}));b("finished loading")}}]);